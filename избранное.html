<style>
.add-wishlist {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
    border: none;
    background: none;
    width: 24px;
    height: 24px;
}

.add-wishlist svg {
    width: 100%;
    height: 100%;
}

.add-wishlist--selected svg path {
    fill: red;
}
.product-item-add-wishlist {
    position: absolute;
    top: 20px;
    left: 20px;
    z-index: 199;
    background-color: white;
    border-radius: 50%;
    width: 34px;
    height: 34px;
    padding: 8px;
    cursor: pointer;
}
.product-detail-add-wishlist {
    position: absolute;
    top: 20px;
    left: 20px;
    z-index: 199;
    background-color: white;
    border-radius: 50%;
    width: 34px;
    height: 34px;
    padding: 8px;
    cursor: pointer;
}
</style>

<button class="product-item-add-wishlist add-wishlist" data-wishlist-id="<?= $arResult['ID'] ?>" onclick="addWishlist(<?= $arResult['ID'] ?>)">
    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M3.86253 1.62503C2.01566 1.91566 0.606284 3.35315 0.340659 5.21565C0.293784 5.5469 0.321909 6.40003 0.390659 6.70003C0.528159 7.3094 0.784409 7.86566 1.14378 8.34378C1.30316 8.55316 2.20003 9.46878 4.20941 11.4719C7.26566 14.5188 7.13753 14.4032 7.57816 14.5188C7.77816 14.575 8.22191 14.575 8.42191 14.5188C8.86253 14.4032 8.73441 14.5188 11.7907 11.4719C14.7844 8.4844 14.9375 8.31878 15.2282 7.75941C15.3907 7.44691 15.5594 6.95628 15.6282 6.60941C15.6938 6.27191 15.6875 5.27503 15.6157 4.93753C15.4375 4.10628 15.0532 3.39378 14.4688 2.81253C13.8813 2.22191 13.1688 1.84065 12.2969 1.65003C11.9969 1.58441 10.925 1.5969 10.5938 1.66878C9.74378 1.85315 9.10628 2.20941 8.41566 2.88753L8.00003 3.29065L7.58441 2.8844C6.89691 2.21565 6.29691 1.87503 5.46878 1.68128C5.16566 1.61253 4.17816 1.57816 3.86253 1.62503ZM5.18753 2.64378C5.53128 2.71565 5.92816 2.8719 6.23753 3.06565C6.44691 3.19378 6.65941 3.38128 7.14066 3.85003C8.03441 4.7219 7.97191 4.71878 8.83128 3.8719C9.27816 3.4344 9.50628 3.2344 9.72191 3.09378C10.3469 2.69065 11.0782 2.51565 11.8032 2.59378C12.9532 2.71565 13.9032 3.38441 14.3907 4.4094C14.5625 4.78128 14.65 5.0969 14.6844 5.49065C14.75 6.26253 14.5782 6.96253 14.1657 7.59065C14.0188 7.81565 13.55 8.30003 11.2063 10.65C9.32191 12.5375 8.38128 13.4594 8.29378 13.5C8.21566 13.5375 8.10316 13.5625 8.00003 13.5625C7.89691 13.5625 7.78441 13.5375 7.70628 13.5C7.61878 13.4594 6.67816 12.5375 4.79378 10.65C2.45003 8.30003 1.98128 7.81565 1.83441 7.59065C1.42191 6.96253 1.25003 6.26253 1.31566 5.49065C1.46253 3.79065 2.95316 2.49378 4.65628 2.58128C4.81878 2.59065 5.05941 2.61878 5.18753 2.64378Z" fill="black"/>
    </svg>
    <svg width="16" height="16" viewBox="0 0 512 458" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M8.1 1.89999C-2.7 7.60001 -2.7 23.8 8.1 29.2C11.2 30.8 15.1 31 42.8 31H74L75.8 33.3C77.6 35.7 145.8 286.6 144.9 287.5C144.7 287.8 142 288.4 139 289C122 292.2 107 305.9 102.6 322.4C101.3 327.3 100.9 331.2 101.3 338.4C101.7 346.6 102.3 348.9 105.3 355.2C109.6 364.1 116 371.3 123.7 376C132.2 381.1 140.3 382.9 155.7 382.9L168.8 383L166.8 388.7C163.9 397 164 411.2 166.9 420.5C173.7 442.5 194.8 458 218.1 458C224.9 458 237.5 454.5 244 450.8C255.4 444.3 265.2 431.5 268.6 418.5C271.2 408.5 270.3 393.8 266.6 384.7C265.9 383.1 268.5 383 312.1 383H358.3L357.6 385.2C354.7 394.7 353.9 400.1 354.4 408C355.6 427.5 366.2 443.5 383.6 452.1C412 466.1 445.2 453.1 456.8 423.3C459.1 417.4 459.5 415 459.5 405C459.5 395.7 459.1 392.4 457.4 387.9L455.4 382.3L458.8 379.5C462.6 376.5 465.1 371.7 465.1 367.3C465.1 363.1 461.5 356.7 457.9 354.5C454.7 352.5 451.8 352.5 299.1 352C144.4 351.5 143.6 351.5 140.1 349.4C135.8 346.9 132.1 340.7 132.1 336C132.1 330.9 135.9 323.9 140.1 321.5C143.6 319.5 145.3 319.5 296.1 319L448.6 318.5L454.3 315.8C461.5 312.5 468 306.5 471.5 300.1C473.6 296.2 478.6 276.2 493.1 213.3C514.6 120.5 514.4 121.7 508.8 110.9C505.3 104.1 499 98.4 492.3 96C488.7 94.7 370.8 93.6 178.5 93.1L125.4 93L116.1 58.7C104.8 17 103 13 92.3 6.19998C83.6 0.600006 79.1 0 43.6 0C14.3 0 11.3 0.199982 8.1 1.89999ZM200.4 127.2C200.8 129 202.6 142.6 204.6 157.5C206.5 172.3 208.3 186 208.6 187.8L209.2 191L180.4 190.8L151.6 190.5L143.4 160C138.9 143.2 134.9 128.3 134.6 126.7L133.9 124H166.9H199.9L200.4 127.2ZM284.4 124.7L297.1 125.3V158.2V191H268.6C242.1 191 240.1 190.9 240.1 189.2C240.1 188.3 238.1 173.2 235.8 155.7L231.5 124H251.5C262.6 124 277.3 124.3 284.4 124.7ZM392.4 127.2C392 129.7 384.1 189.9 384.1 190.6C384.1 190.8 371.5 191 356.1 191H328.1V158V125H360.5H392.8L392.4 127.2ZM481.1 126.2C481 126.9 477.7 141.7 473.7 159L466.4 190.5L440.7 190.8L415.1 191L415.6 188.8C415.8 187.5 417.7 174.1 419.6 159C421.6 143.9 423.4 130 423.7 128.2L424.3 125H452.7C474.8 125 481.1 125.3 481.1 126.2ZM213.6 225.2C213.9 227 215.7 240.6 217.6 255.5C219.6 270.3 221.4 283.7 221.7 285.2L222.3 288H201.8C183.8 288 181.1 287.8 179.2 286.2C177.5 284.9 175.2 278.1 169 255C164.7 238.8 160.8 224.8 160.5 223.8C160 222.1 161.5 222 186.5 222H213L213.6 225.2ZM297.1 255V288H275.1C258.2 288 253.1 287.7 253.1 286.7C253.1 286.1 251.1 271.2 248.8 253.7L244.5 222H270.8H297.1V255ZM379.7 224.7C379.4 226.3 377.5 239.9 375.6 255C373.6 270.1 371.8 283.7 371.5 285.2L370.9 288H349.5H328.1V255V222H354.2H380.3L379.7 224.7ZM458.7 223.7C458.5 224.7 455.3 238.4 451.7 254.2C448 270 444.8 283.6 444.5 284.5C443.3 287.5 440.1 288 421.7 288C403.7 288 403.1 287.9 403.1 286C403.1 284.8 404.9 270.3 407.1 253.8C409.3 237.2 411.1 223.2 411.1 222.8C411.1 222.4 421.9 222 435.2 222C457.6 222 459.2 222.1 458.7 223.7ZM224.2 384.1C239.4 388.7 244.1 408.9 232.5 420.3C227.9 424.9 224.2 426.4 217.5 426.5C212.5 426.5 210.6 426 206.5 423.5C193.7 415.6 191.9 399.1 202.8 388.8C208.4 383.4 216.2 381.7 224.2 384.1ZM415.6 384.9C430.2 391.6 433.5 408.7 422.3 419.9C412.9 429.2 401.3 429.3 392.1 420C385.2 413.2 383.3 404.5 387 396.5C390.7 388.5 398.8 383 407.1 383C409.6 383 413.4 383.9 415.6 384.9Z" fill="black"/>
    </svg>    
</button>

<script>
function getCookie(name) {
    let matches = document.cookie.match(new RegExp(
        "(?:^|; )" + name.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g, '\\$1') + "=([^;]*)"
    ));
    return matches ? decodeURIComponent(matches[1]) : undefined;
}

function setCookie(name, value, options = {}) {

    options = {
        path: '/',
        ...options
    };

    if (options.expires instanceof Date) {
        options.expires = options.expires.toUTCString();
    }

    let updatedCookie = encodeURIComponent(name) + "=" + encodeURIComponent(value);

    for (let optionKey in options) {
        updatedCookie += "; " + optionKey;
        let optionValue = options[optionKey];
        if (optionValue !== true) {
            updatedCookie += "=" + optionValue;
        }
    }

    document.cookie = updatedCookie;
}

const wishlistCookieName = "wishlistIds";
let tmpWishlistCookie = getCookie(wishlistCookieName);

if (tmpWishlistCookie) { 
    const ids = tmpWishlistCookie.split(',');
    ids && ids.forEach(id => {
        const wishlistProduct = document.querySelector(`[data-wishlist-id="${id}"]`);
        wishlistProduct && wishlistProduct.classList.add('add-wishlist--selected')
    });
}

const wishlistProducts = document.querySelectorAll(`[data-wishlist-id]`);
wishlistProducts && wishlistProducts.forEach(wishlistProduct => {
    wishlistProduct.addEventListener('click', function() {
        wishlistProduct.classList.toggle('add-wishlist--selected');
    });
});

function addWishlist(id) {
    let tmpWishlistCookie = getCookie(wishlistCookieName);
    if (tmpWishlistCookie) {
        const ids = tmpWishlistCookie.split(',');
        const searchable = ids.find(elem => elem == id);
        if (!searchable) {
            ids.push(id);
            setCookie(wishlistCookieName, ids.join(","));
        } else {
            const filteredIds = ids.filter(elem => elem != id);
            setCookie(wishlistCookieName, filteredIds.join(","));
        }
        return;
    }
    setCookie(wishlistCookieName, id);
}
</script>

getWishlistCookie
<?php
$cookieName = 'wishlistIds';
if (isset($_COOKIE[$cookieName]) && !empty($_COOKIE[$cookieName])) {
    return preg_replace('/[^0-9,]/', '', $_COOKIE[$cookieName]); // Очищаем значение куки, оставляя только цифры и запятые
}
return 'empty';


[[!If?
    &subject=`[[!getWishlistCookie]]`
    &operator=`neq`
    &operand=`empty`
    &then=`
        [[!pdoPage?
            &setMeta=`0`
            &parents=`0`
            &resources=`[[!getWishlistCookie]]`
            &tpl=`ListProductTpl`
            &includeTVs=`quantP,imageP,priceP,characteristicsP,descriptionP,menutitle`
            &sortby=`{"menuindex":"ASC"}`
        ]]
    `
    &else=`
        <p>Список избранного пуст.</p>
    `
]]

[[!pdoPage?
            &setMeta=`0`
            &parents=`0`
            &resources=`[[!getWishlistCookie]]`
            &tpl=`ListProductTpl`
            &includeTVs=`quantP,imageP,priceP,characteristicsP,descriptionP,menutitle`
            &sortby=`{"menuindex":"ASC"}`
        ]]
        [[!getPage? &sortbyTV=`kvadratmetr` &sortdirTV=`ASC` &elementClass=`modSnippet` &element=`getResources` &parents=`0` &resources=`[[!getWishlistCookie]]` &tpl=`recallTpl` &limit=`9`&includeTVs=`1` &hideContainers=`1` &pageLimit=`5` &pageNavVar=`page.nav`]]
